
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" /> <!-- Define a codificação de caracteres -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <!-- Torna o site responsivo -->
  <title>Cafeteria</title> <!-- Título da aba do navegador -->
  
  <link href="https://fonts.googleapis.com/css2?family=Inter&display=swap" rel="stylesheet" /> <!-- Fonte externa Inter -->

  <style>
    /* Paleta de cores personalizada */
    :root {
      --spanish-white: #DED0B6;
      --castaway-lagoon: #607274;
      --bread-and-butter: #FAEED1;
      --deer-run: #B2A59B;
    }

    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--bread-and-butter);
      font-size: medium;
      color: var(--castaway-lagoon);
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    .menu {
      display: block;
      background-color: var(--deer-run);
      padding: 6px;
    }

    .top-bar {
      display: flex;
      align-items: center;
      margin-bottom: 6px;
      flex-direction: row;
    }

    .btn-mais, .btn-menos {
      background-color: var(--castaway-lagoon);
      color: var(--bread-and-butter);
      border: none;
      border-radius: 4px;
      padding: 4px 10px;
      font-size: large;
      cursor: pointer;
      transition: 0.2s ease;
    }

    .back-btn {
      font-size: 60px;
      background: none;
      color: #FAEED1;
      border: none;
      margin-right: 10px;
      border-radius: 50px;
      cursor: pointer;
    }

    .search input {
      padding: 8px 12px;
      border: none;
      border-radius: 8px;
      background-color: var(--bread-and-butter);
      color: #607274;
      outline: none;
      position: absolute;
      right: 50%;
      font-size: large;
    }

    .header {
      display: flex;
      justify-content: space-between;
    }

    .display {
      background-image: url(https://img.freepik.com/vetores-premium/biscoitos-de-chocolate-com-padrao-de-biscoito-de-chocolate-biscoitos-sem-costura-desenho-doodle-biscoitos-fundo_698782-4339.jpg);
      font-size: large;
      padding-bottom: 25px;
      padding-top: 25px;
    }

    .pngzinho {
      position: absolute;
      right: 650px;
      top: 89px;
    }

    .sidebar {
      position: fixed;
      top: 0;
      right: 0;
      width: 22%;
      height: 92vh;
      background-color: var(--castaway-lagoon);
      color: #FFF;
      border-top-left-radius: 100px;
      border-bottom-left-radius: 100px;
      padding: 40px 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    .linha1 {
      border: none;
      height: 1px;
      background-color: #FAEED1;
      margin: 20px;
      width: 100%;
      top: 7%;
      position: absolute;
    }

    .linha2 {
      border: none;
      height: 1px;
      background-color: #FAEED1;
      margin: 20px;
      width: 104.3%;
      top: 70%;
      left: -8%;
      position: absolute;
    }

    #precoProduto {
      font-size: large;
      font-weight: bold;
      margin-top: 10px;
      position: absolute;
      bottom: 20%;
      left: 10%;
    }

    .continuar {
      border: none;
      border-radius: 8px;
      background-color: #FAEED1;
      color: #607274;
      height: 40px;
      font-size: medium;
      width: 60%;
      position: absolute;
      top: 85%;
      right: 100px;
      padding: 5px;
      cursor: pointer;
    }

    #nomeUser {
      position: absolute;
      top: 0%;
    }
 .biscoitos {
  display: flex;
  justify-content: space-evenly;
  flex-wrap: wrap;
  padding: 40px 20px 60px 20px;
  margin-right: 24%; /* Deixa espaço pra sidebar */
  box-sizing: border-box;
}

.biscoito {
  width: 320px;
  text-align: center;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.biscoito h2 {
  font-size: 20px;
  margin-bottom: 14px;
  color: var(--castaway-lagoon);
}

.biscoito img {
  width: 100%;
  height: 220px;
  object-fit: cover;
  border-radius: 10px;
  border: 2px solid var(--castaway-lagoon);
  cursor: pointer;
  box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.1);
}

    #listaProdutos {
      margin-top: 10px;
      text-align: center;
      width: 100%;
      position: absolute;
      top: 10%;
      font-size: large;
    }
  </style>
</head>

<body>
  <header>
      <div class="menu">
        <div class="top-bar">
           <button class="back-btn" onclick="history.back()">&#8592;</button>
          <div class="search">
            <input type="search" id="searchbar" placeholder="Pesquisar" onclick="fltrarlista"> 
        </div>
      

      <div class="sidebar"> <!-- Barra lateral com carrinho -->
        <h1 id="nomeUser">Carregando...</h1>

        <hr class="linha1" />
        <div id="listaProdutos"></div> <!-- Lista de produtos no carrinho -->
        <hr class="linha2" />

        <h3 id="precoProduto">Total: R$ 0,00</h3> <!-- Total do carrinho -->

        <form id="formFinalizar" action="fig11.php" method="POST">
          <input type="hidden" name="produtos" id="inputProdutos"> <!-- Produtos no carrinho -->
          <input type="hidden" name="total" id="inputTotal"> <!-- Total do carrinho -->
          <a href="http://localhost/trabaio/fig11.php"><button class="continuar">CONTINUAR</button> <!-- Botão de finalizar --></a>
        </form>
      </div>
    </div>
  </header>

  <div class="display">
    <h1>Biscoitos</h1> <!-- Título da vitrine -->
  </div>

  <div class="pngzinho">
    <img src="https://cdn.awsli.com.br/600x450/1869/1869529/produto/251940020/petit-coco-ph5b9kaale.png" alt="pngzinho" width="140px">
  </div>

  <div class="biscoitos">
  <!-- Produto 1 -->
  <div class="biscoito">
    <h2>Biscoito de queijo</h2>
    <img class="produto" data-id="7" src="https://receitasdoclau.com.br/wp-content/uploads/2025/01/biscoito-de-queijo-mineiro.jpg" alt="droga">
  </div>

  <!-- Produto 2 -->
  <div class="biscoito">
    <h2>Biscoito amanteigado</h2>
    <img class="produto" data-id="8" src="https://i.ytimg.com/vi/GBjCeJN0MkY/maxresdefault.jpg" alt="biscrock">
  </div>

  <!-- Produto 3 -->
  <div class="biscoito">
    <h2>Sequilhos</h2>
    <img class="produto" data-id="9" src="https://d1uz88p17r663j.cloudfront.net/original/d7345b79333951a436d5a885db288711_sequilhos-receitas-nestle.jpg" alt="candy">
  </div>
</div>
  <script>
   document.addEventListener('DOMContentLoaded', () => {
  // Carrega o carrinho da sessão via PHP (listar)
  function carregarCarrinho() {
    return fetch('carrinho.php?acao=listar')
      .then(res => res.json())
      .then(data => data.carrinho || {})
      .catch(() => ({}));
  }

  let cart = {};

  fetch("get_user.php")
    .then(res => res.json())
    .then(data => {
      const h1 = document.getElementById("nomeUser");
      h1.textContent = data.nome || "Visitante";
    })
    .catch(() => {
      document.getElementById("nomeUser").textContent = "Visitante";
    });

  const lista   = document.getElementById('listaProdutos');
  const totalEl = document.getElementById('precoProduto');

  function atualizarSidebar() {
    if (!lista || !totalEl) return;

    lista.innerHTML = '';
    let total = 0;

    Object.entries(cart).forEach(([id, item]) => {
      const subtotal = item.qty * item.preco;
      total += subtotal;

      lista.insertAdjacentHTML('beforeend', `
        <div class="item-linha">
          <button class="btn-menos" onclick="alterarQuantidade('${id}', -1)">−</button>
          <strong>${item.nome}</strong> × ${item.qty} – R$ ${subtotal.toFixed(2).replace('.', ',')}
          <button class="btn-mais"  onclick="alterarQuantidade('${id}', 1)">+</button>
        </div>
      `);
    });

    totalEl.textContent = `Total: R$ ${total.toFixed(2).replace('.', ',')}`;

    const inputProdutos = document.getElementById('inputProdutos');
    const inputTotal    = document.getElementById('inputTotal');
    if (inputProdutos && inputTotal) {
      const nomes = Object.values(cart).map(it => `${it.nome} x${it.qty}`);
      inputProdutos.value = nomes.join(', ');
      inputTotal.value    = total.toFixed(2);
    }
  }

  window.alterarQuantidade = function (id, delta) {
    fetch(`carrinho.php?acao=alterar&id=${encodeURIComponent(id)}&delta=${delta}`)
      .then(res => res.json())
      .then(data => {
        cart = data.carrinho || {};
        atualizarSidebar();
      })
      .catch(console.error);
  };

  carregarCarrinho().then(carrinhoDaSessao => {
    cart = carrinhoDaSessao;
    atualizarSidebar();
  });

  document.querySelectorAll('[data-id]').forEach(el => {
    el.addEventListener('click', () => {
      const id = el.getAttribute('data-id');

      fetch(`get_produto.php?id=${id}`)
        .then(r => r.json())
        .then(prod => {
          // Envia para carrinho.php para adicionar
          const formData = new FormData();
          formData.append('id', id);
          formData.append('nome', prod.nome);
          formData.append('preco', prod.preco_base || prod.preco);

          fetch('carrinho.php?acao=adicionar', {
            method: 'POST',
            body: formData
          })
          .then(res => res.json())
          .then(data => {
            cart = data.carrinho || {};
            atualizarSidebar();
          })
          .catch(console.error);
        })
        .catch(console.error);
    });
  });
});

  </script>
</body>
</html>
